<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Catatan Hutang</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'SF Pro Display', 'Segoe UI', sans-serif;
            background: #FAFAFA;
            min-height: 100vh;
            color: #1A1A1A;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 32px 24px;
        }

        /* ── Header ── */
        .header {
            background: white;
            border-radius: 16px;
            padding: 20px 28px;
            margin-bottom: 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
            border: 1px solid #F0F0F0;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-title {
            font-size: 22px;
            font-weight: 600;
            color: #1A1A1A;
            letter-spacing: -0.3px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .company-badge {
            background: #F0F9FF;
            color: #0369A1;
            padding: 8px 18px;
            border-radius: 10px;
            font-weight: 500;
            font-size: 13px;
            border: 1px solid #E0F2FE;
            transition: all 0.2s;
        }

        .company-badge:hover {
            background: #E0F2FE;
            border-color: #BAE6FD;
            transform: translateY(-1px);
        }

        .logout-btn {
            width: 38px; height: 38px;
            border-radius: 10px;
            background: #FEF2F2;
            border: 1px solid #FEE2E2;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .logout-btn:hover { background: #FEE2E2; }
        .logout-btn svg { width: 18px; height: 18px; stroke: #DC2626; }

        /* ── Summary Cards ── */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 8px;
            margin-top: 12px;
        }

        .summary-card {
            background: #F8F8F8;
            border-radius: 8px;
            padding: 6px 10px;
            border: 1px solid #F0F0F0;
        }

        .summary-card h3 {
            font-size: 9px;
            font-weight: 600;
            color: #8E8E93;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }

        .summary-value {
            font-size: 12px;
            font-weight: 700;
            color: #1A1A1A;
        }

        .summary-card.danger .summary-value  { color: #DC2626; }
        .summary-card.success .summary-value { color: #059669; }
        .summary-card.warning .summary-value { color: #D97706; }

        /* ── Main Card ── */
        .card {
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
            border: 1px solid #F0F0F0;
            margin-bottom: 24px;
        }

        /* ── Toolbar ── */
        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .toolbar-left {
            display: flex;
            gap: 12px;
            align-items: center;
            flex: 1;
        }

        .toolbar-right {
            display: flex;
            gap: 8px;
        }

        .search-box {
            display: flex; align-items: center; gap: 8px;
            background: #F8F8F8;
            border: 1px solid #E5E5E5;
            border-radius: 10px;
            padding: 10px 14px;
            flex: 1;
            transition: all 0.2s;
        }
        .search-box:focus-within { background: white; border-color: #3b82f6; }
        .search-box svg { width: 18px; height: 18px; stroke: #A3A3A3; flex-shrink: 0; }
        .search-box input {
            border: none; background: transparent; outline: none;
            font-size: 14px; width: 100%; color: #1A1A1A;
        }
        .search-box input::placeholder { color: #A3A3A3; }

        .btn-icon-add {
            width: 40px; height: 40px; min-width: 40px;
            border-radius: 12px;
            background: #F8F8F8;
            border: 1px solid #E5E5E5;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        .btn-icon-add:hover { background: #EFEFEF; border-color: #D4D4D4; }
        .btn-icon-add svg { stroke: #525252; }

        .add-menu-wrapper { position: relative; }

        .add-dropdown-menu {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            border: 1px solid #E5E5E5;
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s;
            z-index: 100;
            overflow: hidden;
        }
        .add-dropdown-menu.show { opacity: 1; visibility: visible; transform: translateY(0); }

        .dropdown-item {
            width: 100%;
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border: none;
            background: white;
            cursor: pointer;
            font-size: 14px;
            color: #1A1A1A;
            transition: all 0.2s;
            text-align: left;
            font-family: inherit;
        }
        .dropdown-item:hover { background: #F8F8F8; }
        .dropdown-item svg { width: 18px; height: 18px; stroke: #525252; flex-shrink: 0; }
        .dropdown-item:first-child { border-radius: 12px 12px 0 0; }
        .dropdown-item:last-child { border-radius: 0 0 12px 12px; }
        .dropdown-item:not(:last-child) { border-bottom: 1px solid #F0F0F0; }

        .btn {
            padding: 10px 18px;
            border-radius: 10px;
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex; align-items: center; gap: 8px;
            white-space: nowrap;
        }
        .btn svg { width: 16px; height: 16px; stroke: currentColor; }
        .btn-outline { background: white; color: #525252; border: 1px solid #E5E5E5; }
        .btn-outline:hover { background: #F8F8F8; }
        .btn-primary { background: #0369A1; color: white; }
        .btn-primary:hover { background: #075985; }
        .btn-danger  { background: #DC2626; color: white; }
        .btn-danger:hover  { background: #B91C1C; }
        .btn-success { background: #059669; color: white; }
        .btn-success:hover { background: #047857; }

        /* ── Tabs ── */
        .tabs {
            display: flex;
            gap: 8px;
            margin-top: 8px;
            margin-bottom: 20px;
            background: #F8F8F8;
            padding: 6px;
            border-radius: 12px;
        }

        .tab-btn {
            flex: 1;
            padding: 10px 20px;
            background: transparent;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #737373;
            transition: all 0.2s;
        }
        .tab-btn.active {
            background: white;
            color: #1A1A1A;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }

        /* ── iOS Table ── */
        .table-scroll-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin: 0 -32px;
            padding: 0 32px;
        }

        .ios-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 10px;
            min-width: 900px;
        }

        .ios-table thead th {
            padding: 8px 16px;
            text-align: left;
            font-size: 12px;
            font-weight: 600;
            color: #8E8E93;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: none;
            background: transparent;
        }

        .ios-row {
            background: white;
            border-radius: 14px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
            transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
        }
        .ios-row:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08), 0 2px 4px rgba(0,0,0,0.06);
        }
        .ios-row td:first-child { border-radius: 14px 0 0 14px; }
        .ios-row td:last-child  { border-radius: 0 14px 14px 0; }

        .ios-cell {
            padding: 16px;
            font-size: 14px;
            color: #1A1A1A;
            font-weight: 500;
            border: none;
            background: white;
        }

        .status-badge {
            display: inline-flex;
            padding: 4px 10px;
            border-radius: 7px;
            font-size: 11px;
            font-weight: 500;
        }
        .status-belum { background: #FEE2E2; color: #991B1B; }
        .status-lunas { background: #D1FAE5; color: #065F46; }


        .action-btns { display: flex; gap: 6px; }

        .icon-btn {
            width: 30px; height: 30px;
            border-radius: 8px;
            border: 1px solid;
            background: white;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
        }
        .icon-btn svg { width: 16px; height: 16px; stroke: currentColor; }
        .icon-btn-edit  { border-color: #BFDBFE; color: #1E40AF; }
        .icon-btn-edit:hover  { background: #DBEAFE; }
        .icon-btn-delete { border-color: #FECACA; color: #991B1B; }
        .icon-btn-delete:hover { background: #FEE2E2; }
        .icon-btn-pay { border-color: #A7F3D0; color: #065F46; }
        .icon-btn-pay:hover { background: #D1FAE5; }

        .cell-bayar:hover { text-decoration: underline; }


        /* ── Pagination ── */
        .pagination-footer {
            margin-top: 20px;
            padding-top: 16px;
            border-top: 1px solid #F0F0F0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            color: #737373;
        }

        .pagination-center {
            display: flex;
            gap: 8px;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .pagination-left {
            display: flex;
            gap: 8px;
            align-items: center;
            justify-content: flex-start;
            font-size: 13px;
            color: #525252;
            font-weight: 500;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .pagination-left select {
            padding: 6px 10px;
            border: 1px solid #E5E5E5;
            border-radius: 10px;
            font-size: 13px;
            background: white;
            cursor: pointer;
            font-weight: 500;
            color: #1A1A1A;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
        }

        .pagination-left select:hover {
            border-color: #3B82F6;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .pagination-left select:focus {
            outline: none;
            border-color: #3B82F6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.08), 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .pagination-right {
            font-size: 13px;
            color: #525252;
            text-align: right;
            font-weight: 500;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .nav-btn {
            width: 34px;
            height: 34px;
            min-width: 34px;
            min-height: 34px;
            border: 2px solid #E5E5E5;
            background: linear-gradient(to bottom, #FFFFFF, #FAFAFA);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            color: #525252;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.04);
            position: relative;
            flex-shrink: 0;
        }

        .nav-btn::before {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: 10px;
            padding: 2px;
            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.25s;
        }

        .nav-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%);
            border-color: #2563EB;
            color: white;
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3), 0 4px 8px rgba(59, 130, 246, 0.15);
        }

        .nav-btn:hover:not(:disabled)::before { opacity: 1; }

        .nav-btn:active:not(:disabled) {
            transform: translateY(0) scale(1);
            box-shadow: 0 2px 6px rgba(59, 130, 246, 0.2);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #F5F5F5;
            border-color: #E5E5E5;
            color: #A3A3A3;
            box-shadow: none;
        }

        .nav-btn svg {
            stroke: currentColor;
            transition: transform 0.2s ease;
            position: relative;
            z-index: 1;
            width: 16px;
            height: 16px;
        }

        .nav-btn:hover:not(:disabled) svg { transform: scale(1.15); }

        .page-info {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            color: #525252;
            font-weight: 500;
            margin: 0 4px;
        }

        .page-input {
            width: 45px;
            padding: 6px 8px;
            border: 1px solid #E5E5E5;
            border-radius: 10px;
            text-align: center;
            font-size: 13px;
            font-weight: 500;
            color: #1A1A1A;
            background: white;
            transition: all 0.2s;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
        }

        .page-input:focus {
            outline: none;
            border-color: #3B82F6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.08), 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .page-input::-webkit-inner-spin-button,
        .page-input::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* ── Modal ── */
        .modal {
            display: none;
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: flex-start; justify-content: center;
            padding: 40px 20px 20px;
            overflow-y: auto;
        }
        .modal.show { display: flex; }

        .modal-content {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 640px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }

        .modal-header {
            padding: 24px 28px;
            border-bottom: 1px solid #F0F0F0;
            display: flex; justify-content: space-between; align-items: center;
            position: sticky; top: 0; background: white; border-radius: 20px 20px 0 0;
            z-index: 1;
        }
        .modal-title { font-size: 20px; font-weight: 600; color: #1A1A1A; }

        .close-modal {
            width: 32px; height: 32px;
            border-radius: 8px; border: none;
            background: #F8F8F8;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
        }
        .close-modal:hover { background: #EFEFEF; }
        .close-modal svg { width: 18px; height: 18px; stroke: #525252; }

        .modal-body { padding: 28px; }

        .modal-form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }
        .modal-form-grid .form-group.full { grid-column: 1 / -1; }

        .form-group { margin-bottom: 0; }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
            color: #404040;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid #E5E5E5;
            border-radius: 10px;
            font-size: 14px;
            font-family: inherit;
            color: #1A1A1A;
            background: #FAFAFA;
            transition: all 0.2s;
        }
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #0369A1;
            background: white;
            box-shadow: 0 0 0 3px rgba(3,105,161,0.1);
        }
        .form-group textarea { resize: vertical; min-height: 80px; }

        .modal-footer {
            padding: 20px 28px;
            border-top: 1px solid #F0F0F0;
            display: flex; justify-content: flex-end; gap: 10px;
        }

        .modal-footer .btn {
            min-width: 100px;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
            padding: 11px 24px;
            border-radius: 12px;
        }

        .modal-footer .btn-primary {
            background: #0369A1;
            color: white;
            border: none;
            box-shadow: 0 2px 8px rgba(3, 105, 161, 0.3);
        }

        .modal-footer .btn-primary:hover {
            background: #075985;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(3, 105, 161, 0.4);
        }

        .modal-footer .btn-outline {
            background: white;
            color: #525252;
            border: 1px solid #E5E5E5;
        }

        .modal-footer .btn-outline:hover {
            background: #F8F8F8;
        }

        /* ── Empty state ── */
        .empty-state {
            text-align: center; padding: 60px 20px;
        }
        .empty-state svg { width: 60px; height: 60px; stroke: #D4D4D4; margin-bottom: 16px; }
        .empty-state h3 { font-size: 18px; color: #404040; margin-bottom: 8px; }
        .empty-state p { color: #737373; font-size: 14px; }

        /* ── Responsive ── */
        @media (max-width: 768px) {
            .container { padding: 20px 16px; }
            .header { padding: 16px 20px; margin-bottom: 20px; }
            .header-title { font-size: 17px; }
            .company-badge { display: none; }
            .card { padding: 20px 16px; }
            .table-scroll-wrapper { margin: 0 -16px; padding: 0 16px; }
            .ios-table { border-spacing: 0 8px; }
            .ios-cell { padding: 10px 10px !important; font-size: 12px !important; }
            .ios-table thead th { padding: 6px 10px !important; font-size: 10px !important; }
            .modal-form-grid { grid-template-columns: 1fr; }
            .modal-form-grid .form-group.full { grid-column: 1; }
            .summary-cards { grid-template-columns: repeat(3, 1fr); gap: 8px; }
            .toolbar { flex-direction: row; flex-wrap: wrap; }
            .toolbar-left { flex: 1; }

            .pagination-footer {
                gap: 8px;
                font-size: 11px;
            }

            .pagination-center {
                gap: 4px;
            }

            .pagination-left {
                gap: 4px;
            }

            .pagination-left span {
                display: none;
            }

            .pagination-left select {
                padding: 4px 6px;
                font-size: 11px;
            }

            .pagination-right {
                font-size: 11px;
            }

            .nav-btn {
                width: 28px;
                height: 28px;
            }

            .page-input {
                width: 35px;
                padding: 4px 6px;
                font-size: 11px;
            }
        }

        @media (max-width: 480px) {
            .summary-cards { grid-template-columns: 1fr; }
            .summary-value { font-size: 15px; }
        }
            /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            left: -320px;
            width: 320px;
            height: 100vh;
            background: white;
            box-shadow: 4px 0 24px rgba(0, 0, 0, 0.08);
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            overflow-y: auto;
        }
        .sidebar.open { left: 0; }
        .sidebar-menu { padding: 24px 12px; }
        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 16px;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            color: #525252;
            border-radius: 12px;
            margin-bottom: 4px;
            font-size: 15px;
        }
        .sidebar-item:hover { background: #F8F8F8; color: #1A1A1A; }
        .sidebar-item.active { background: #F0F9FF; color: #0369A1; }
        .sidebar-item svg { width: 20px; height: 20px; stroke: currentColor; }
        .sidebar-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.4);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 999;
            backdrop-filter: blur(2px);
        }
        .sidebar-overlay.show { opacity: 1; visibility: visible; }
        @media (max-width: 768px) {
            .sidebar { width: 85%; max-width: 320px; }
            .sidebar-item { padding: 16px; margin-bottom: 6px; min-height: 52px; }
            .sidebar-item svg { width: 22px; height: 22px; }
        }

        .hamburger-btn {
            width: 38px;
            height: 38px;
            border-radius: 10px;
            background: #F8F8F8;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .hamburger-btn:hover { background: #EFEFEF; }
        .hamburger-btn svg { width: 20px; height: 20px; stroke: #1A1A1A; }
        @media (max-width: 768px) {
            .hamburger-btn { width: 44px; height: 44px; min-width: 44px; }
            .hamburger-btn svg { width: 22px; height: 22px; }
        }
</style>
</head>
<body>
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-menu">
            <a href="dasbord.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Dashboard</span>
            </a>
            <a href="usermanagemen.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>User Management</span>
            </a>
            <a href="emailmanagement.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Email Management</span>
            </a>
            <a href="catatanhutang.html" class="sidebar-item active">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Catatan Hutang</span>
            </a>
            <a href="laporankaryawan.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Laporan Karyawan</span>
            </a>
            <a href="laporanbensin.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Laporan Bensin</span>
            </a>
            <a href="laporanpembelian.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Laporan Pembelian</span>
            </a>
            <a href="investasi.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Investasi</span>
            </a>
            <a href="jobdesk.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Jobdesk</span>
            </a>
            <a href="daily.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Daily Activity</span>
            </a>
            <a href="laporanpuasa.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Laporan Puasa</span>
            </a>
            <a href="laporansolat.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Laporan Solat</span>
            </a>
            <a href="dasborquran.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Dashboard Quran</span>
            </a>
            <a href="dasborlagu.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Dashboard Lagu</span>
            </a>
            <a href="passwordgenerator.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Password Generator</span>
            </a>
            <a href="randomname.html" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Random Name</span>
            </a>
        </div>
    </div>


<div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <button class="hamburger-btn" onclick="openSidebar()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"/>
                        <line x1="3" y1="6" x2="21" y2="6"/>
                        <line x1="3" y1="18" x2="21" y2="18"/>
                    </svg>
                </button>
                <div class="header-title">Hutang</div>
            </div>
            <div class="header-actions">
                <div class="company-badge">PT. A YANI</div>
                <button class="logout-btn" onclick="handleLogout()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18.36 6.64a9 9 0 1 1-12.73 0"/>
                        <line x1="12" y1="2" x2="12" y2="12"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Main Card -->
        <div class="card">
            <!-- Toolbar -->
            <div class="toolbar">
                <div class="toolbar-left">
                    <div class="search-box">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                        <input type="text" id="searchInput" placeholder="Cari nama..." onkeyup="searchData()">
                    </div>
                </div>
                <div class="toolbar-right">
                    <div class="add-menu-wrapper">
                        <button class="btn-icon-add" onclick="toggleAddMenu(event)" title="Menu">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:18px;height:18px;">
                                <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                        </button>
                        <div class="add-dropdown-menu" id="addDropdownMenu">
                            <button class="dropdown-item" onclick="openAddModal(); closeAddMenu()">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                </svg>
                                Tambah Hutang
                            </button>
                            <button class="dropdown-item" onclick="exportToCSV(); closeAddMenu()">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                                </svg>
                                Export CSV
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Summary Cards -->
            <div class="summary-cards">
                <div class="summary-card danger">
                    <h3>Belum Lunas</h3>
                    <div class="summary-value" id="totalBelumLunas">Rp 0</div>
                </div>
                <div class="summary-card success">
                    <h3>Sudah Lunas</h3>
                    <div class="summary-value" id="totalLunas">Rp 0</div>
                </div>
                <div class="summary-card">
                    <h3>Total Transaksi</h3>
                    <div class="summary-value" id="totalTransaksi">0</div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('all', this)">Semua</button>
                <button class="tab-btn" onclick="switchTab('Belum Lunas', this)">Belum Lunas</button>
                <button class="tab-btn" onclick="switchTab('Lunas', this)">Lunas</button>
            </div>

            <!-- Table -->
            <div class="table-scroll-wrapper">
                <table class="ios-table" id="mainTable">
                    <thead>
                        <tr>
                            <th style="width:50px; text-align:center;">No</th>
                            <th>Nama Pihak</th>
                            <th>Jenis</th>
                            <th>Jumlah</th>
                            <th>Tgl Awal Hutang</th>
                            <th>Jatuh Tempo</th>
                            <th>Status</th>
                            <th>Sudah Dibayar</th>
                            <th>Sisa</th>
                            <th style="text-align:center;">Aksi</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination-footer">
                <div class="pagination-left">
                    <span>Show</span>
                    <select onchange="changeRowsPerPage(this.value)" id="rowsPerPageSelect">
                        <option value="5">5</option>
                        <option value="10" selected>10</option>
                        <option value="15">15</option>
                        <option value="25">25</option>
                    </select>
                    <span>entries</span>
                </div>

                <div class="pagination-center">
                    <button class="nav-btn" id="btnPrev" onclick="goToPrevPage()" title="Previous">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="width:18px;height:18px;">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M15 18l-6-6 6-6"/>
                        </svg>
                    </button>
                    <span class="page-info">
                        Page <input type="number" class="page-input" id="currentPageInput" value="1" min="1" onchange="goToPage(this.value)"> of <span id="totalPages">1</span>
                    </span>
                    <button class="nav-btn" id="btnNext" onclick="goToNextPage()" title="Next">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="width:18px;height:18px;">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 18l6-6-6-6"/>
                        </svg>
                    </button>
                </div>

                <div class="pagination-right">
                    <span id="displayStart">0</span>-<span id="displayEnd">0</span> of <span id="totalItems">0</span> items
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Bayar -->
    <div class="modal" id="payModal">
        <div class="modal-content" style="max-width:400px;">
            <div class="modal-header">
                <h2 class="modal-title">Catat Pembayaran</h2>
                <button class="close-modal" onclick="closePayModal()">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="payId">
                <div style="background:#F8F8F8; border-radius:12px; padding:14px 16px; margin-bottom:20px;">
                    <div style="font-size:12px; color:#8E8E93; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; margin-bottom:6px;">Nama</div>
                    <div style="font-size:15px; font-weight:600; color:#1A1A1A;" id="payNama">-</div>
                    <div style="display:flex; gap:24px; margin-top:12px;">
                        <div>
                            <div style="font-size:11px; color:#8E8E93; margin-bottom:2px;">Total Hutang</div>
                            <div style="font-size:14px; font-weight:700; color:#1A1A1A;" id="payTotal">-</div>
                        </div>
                        <div>
                            <div style="font-size:11px; color:#8E8E93; margin-bottom:2px;">Sudah Dibayar</div>
                            <div style="font-size:14px; font-weight:700; color:#059669;" id="paySudah">-</div>
                        </div>
                        <div>
                            <div style="font-size:11px; color:#8E8E93; margin-bottom:2px;">Sisa</div>
                            <div style="font-size:14px; font-weight:700; color:#DC2626;" id="paySisa">-</div>
                        </div>
                    </div>
                </div>

                <!-- +/- toggle -->
                <div style="display:flex; gap:8px; margin-bottom:14px;">
                    <button id="payBtnPlus" onclick="setPayMode('+')" style="flex:1; padding:9px; border-radius:10px; border:2px solid #059669; background:#D1FAE5; color:#065F46; font-size:15px; font-weight:700; cursor:pointer; transition:all 0.2s;">+ Tambah</button>
                    <button id="payBtnMinus" onclick="setPayMode('-')" style="flex:1; padding:9px; border-radius:10px; border:2px solid #E5E5E5; background:white; color:#737373; font-size:15px; font-weight:700; cursor:pointer; transition:all 0.2s;">− Kurang</button>
                </div>

                <div class="form-group">
                    <label id="payLabel">Jumlah Tambah (Rp)</label>
                    <div style="display:flex; gap:8px;">
                        <button class="btn btn-outline" onclick="setBayarLunas()" id="payLunasBtn" style="white-space:nowrap; font-size:13px; padding:8px 14px;">Lunas Semua</button>
                        <input type="number" id="payJumlah" placeholder="Masukkan nominal..." min="1" style="flex:1; padding:10px 14px; border:1px solid #E5E5E5; border-radius:10px; font-size:14px; outline:none;" onfocus="this.style.borderColor='#3B82F6'" onblur="this.style.borderColor='#E5E5E5'">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closePayModal()">Batal</button>
                <button class="btn btn-primary" onclick="savePembayaran()">Simpan</button>
            </div>
        </div>
    </div>

    <!-- Modal Tambah/Edit -->
    <div class="modal" id="hutangModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Tambah Hutang</h2>
                <button class="close-modal" onclick="closeModal()">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editId">
                <div class="modal-form-grid">
                    <div class="form-group">
                        <label>Nama Peminjam / Pemberi Pinjaman *</label>
                        <input type="text" id="namaPihak" placeholder="Contoh: PT. ABC / Budi Santoso">
                    </div>
                    <div class="form-group">
                        <label>Jenis *</label>
                        <select id="jenisHutang">
                            <option value="">-- Pilih Jenis --</option>
                            <option value="Hutang">Hutang (Saya Berutang)</option>
                            <option value="Piutang">Piutang (Saya Memberi Pinjaman)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Jumlah (Rp) *</label>
                        <input type="number" id="jumlah" placeholder="0" min="0">
                    </div>
                    <div class="form-group">
                        <label>Status *</label>
                        <select id="status">
                            <option value="Belum Lunas">Belum Lunas</option>
                            <option value="Lunas">Lunas</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tgl Awal Hutang *</label>
                        <input type="date" id="tanggalTransaksi">
                    </div>
                    <div class="form-group">
                        <label>Jatuh Tempo</label>
                        <input type="date" id="jatuhTempo">
                    </div>
                    <div class="form-group">
                        <label>Sudah Dibayar (Rp)</label>
                        <input type="number" id="sudahDibayar" placeholder="0" min="0" value="0">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal()">Batal</button>
                <button class="btn btn-primary" onclick="saveHutang()">Simpan</button>
            </div>
        </div>
    </div>

    <script>
        // ── STATE ──
        const defaultData = [
            { id: 1, namaPihak: 'PT. Sumber Makmur', jenis: 'Hutang', jumlah: 5000000, tanggalTransaksi: '2025-01-10', jatuhTempo: '2025-06-10', status: 'Belum Lunas', sudahDibayar: 0, keterangan: 'Pembelian bahan baku' },
            { id: 2, namaPihak: 'Budi Santoso', jenis: 'Piutang', jumlah: 2500000, tanggalTransaksi: '2025-02-05', jatuhTempo: '2025-05-05', status: 'Lunas', sudahDibayar: 2500000, keterangan: 'Pinjaman pribadi' },
            { id: 3, namaPihak: 'CV. Maju Jaya', jenis: 'Hutang', jumlah: 8000000, tanggalTransaksi: '2025-03-01', jatuhTempo: '2025-09-01', status: 'Belum Lunas', sudahDibayar: 3000000, keterangan: 'Pengadaan peralatan' },
            { id: 4, namaPihak: 'Siti Rahayu', jenis: 'Piutang', jumlah: 1000000, tanggalTransaksi: '2025-03-15', jatuhTempo: '2025-04-15', status: 'Belum Lunas', sudahDibayar: 0, keterangan: 'Kasbon karyawan' },
            { id: 5, namaPihak: 'Toko Berkah', jenis: 'Hutang', jumlah: 3200000, tanggalTransaksi: '2025-04-01', jatuhTempo: '2025-07-01', status: 'Lunas', sudahDibayar: 3200000, keterangan: 'Hutang operasional' },
        ];
        let data = JSON.parse(localStorage.getItem('hutangData'));
        if (!data || data.length === 0) {
            data = defaultData;
            localStorage.setItem('hutangData', JSON.stringify(data));
        }
        let filteredData = [...data];
        let currentPage = 1;
        let rowsPerPage = 10;
        let currentTab = 'all';

        // ── RENDER ──
        function renderTable() {
            const tbody = document.getElementById('tableBody');
            const start = (currentPage - 1) * rowsPerPage;
            const end = start + rowsPerPage;
            const pageData = filteredData.slice(start, end);

            if (pageData.length === 0) {
                tbody.innerHTML = `
                    <tr><td colspan="11">
                        <div class="empty-state">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2M9 5a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2M9 5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2"/>
                            </svg>
                            <h3>Belum Ada Data</h3>
                            <p>Klik tombol + di atas untuk menambahkan data hutang baru.</p>
                        </div>
                    </td></tr>`;
            } else {
                tbody.innerHTML = pageData.map((item, idx) => {
                    const sisa = (parseFloat(item.jumlah) || 0) - (parseFloat(item.sudahDibayar) || 0);
                    const statusClass = item.status === 'Lunas' ? 'status-lunas' : 'status-belum';
                    const statusLabel = item.status === 'Lunas' ? 'Sudah' : 'Belum';
                    return `
                    <tr class="ios-row">
                        <td class="ios-cell" style="text-align:center; color:#8E8E93;">${start + idx + 1}</td>
                        <td class="ios-cell" style="font-weight:600;">${item.namaPihak}</td>
                        <td class="ios-cell" style="color:#0369A1;">${item.jenis}</td>
                        <td class="ios-cell">Rp ${formatNum(item.jumlah)}</td>
                        <td class="ios-cell" style="color:#525252;">${item.tanggal}</td>
                        <td class="ios-cell" style="color:#525252;">${item.jatuhTempo || '-'}</td>
                        <td class="ios-cell"><span class="status-badge ${statusClass}">${statusLabel}</span></td>
                        <td class="ios-cell" style="color:#059669; cursor:pointer;" onclick="${item.status !== 'Lunas' ? `openPayModal(${item.id})` : ''}" title="${item.status !== 'Lunas' ? 'Klik untuk catat pembayaran' : ''}">Rp ${formatNum(item.sudahDibayar || 0)}</td>
                        <td class="ios-cell" style="color:${sisa > 0 ? '#DC2626' : '#059669'}; font-weight:600;">Rp ${formatNum(sisa)}</td>
                        <td class="ios-cell">
                            <div class="action-btns">
                                <button class="icon-btn icon-btn-edit" onclick="editHutang(${item.id})" title="Edit">
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                    </svg>
                                </button>
                                <button class="icon-btn icon-btn-delete" onclick="deleteHutang(${item.id})" title="Hapus">
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                    </svg>
                                </button>
                            </div>
                        </td>
                    </tr>`;
                }).join('');
            }

            updatePagination();
            updateSummary();
        }

        function formatNum(n) {
            return Number(n || 0).toLocaleString('id-ID');
        }

        function updatePagination() {
            const total = filteredData.length;
            const totalPgs = Math.ceil(total / rowsPerPage) || 1;
            const start = total > 0 ? (currentPage - 1) * rowsPerPage + 1 : 0;
            const end = Math.min(currentPage * rowsPerPage, total);

            document.getElementById('displayStart').textContent = start;
            document.getElementById('displayEnd').textContent = end;
            document.getElementById('totalItems').textContent = total;
            document.getElementById('totalPages').textContent = totalPgs;
            document.getElementById('currentPageInput').value = currentPage;
            document.getElementById('currentPageInput').max = totalPgs;

            document.getElementById('btnPrev').disabled = currentPage === 1;
            document.getElementById('btnNext').disabled = currentPage >= totalPgs;
        }

        function updateSummary() {
            const belum = data.filter(d => d.status === 'Belum Lunas').reduce((s,d) => s + (parseFloat(d.jumlah)||0) - (parseFloat(d.sudahDibayar)||0), 0);
            const lunas = data.filter(d => d.status === 'Lunas').reduce((s,d) => s + (parseFloat(d.jumlah)||0), 0);
            document.getElementById('totalBelumLunas').textContent = 'Rp ' + formatNum(belum);
            document.getElementById('totalLunas').textContent = 'Rp ' + formatNum(lunas);
            document.getElementById('totalTransaksi').textContent = data.length;
        }

        // ── FILTER & SEARCH ──
        function switchTab(tab, btn) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentTab = tab;
            currentPage = 1;
            applyFilter();
        }

        function searchData() {
            currentPage = 1;
            applyFilter();
        }

        function applyFilter() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            let base = currentTab === 'all' ? [...data] : data.filter(d => d.status === currentTab);
            filteredData = base.filter(d =>
                d.namaPihak.toLowerCase().includes(search)
            );
            renderTable();
        }

        // ── CRUD ──
        // ── BAYAR MODAL ──
        let payMode = '+';

        function setPayMode(mode) {
            payMode = mode;
            const btnPlus = document.getElementById('payBtnPlus');
            const btnMinus = document.getElementById('payBtnMinus');
            const label = document.getElementById('payLabel');
            const lunasBtn = document.getElementById('payLunasBtn');
            if (mode === '+') {
                btnPlus.style.cssText = 'flex:1; padding:9px; border-radius:10px; border:2px solid #059669; background:#D1FAE5; color:#065F46; font-size:15px; font-weight:700; cursor:pointer; transition:all 0.2s;';
                btnMinus.style.cssText = 'flex:1; padding:9px; border-radius:10px; border:2px solid #E5E5E5; background:white; color:#737373; font-size:15px; font-weight:700; cursor:pointer; transition:all 0.2s;';
                label.textContent = 'Jumlah Tambah (Rp)';
                lunasBtn.style.display = '';
            } else {
                btnMinus.style.cssText = 'flex:1; padding:9px; border-radius:10px; border:2px solid #DC2626; background:#FEE2E2; color:#991B1B; font-size:15px; font-weight:700; cursor:pointer; transition:all 0.2s;';
                btnPlus.style.cssText = 'flex:1; padding:9px; border-radius:10px; border:2px solid #E5E5E5; background:white; color:#737373; font-size:15px; font-weight:700; cursor:pointer; transition:all 0.2s;';
                label.textContent = 'Jumlah Kurang (Rp)';
                lunasBtn.style.display = 'none';
            }
        }

        function openPayModal(id) {
            const item = data.find(d => d.id === id);
            if (!item) return;
            const sisa = (parseFloat(item.jumlah) || 0) - (parseFloat(item.sudahDibayar) || 0);
            document.getElementById('payId').value = id;
            document.getElementById('payNama').textContent = item.namaPihak;
            document.getElementById('payTotal').textContent = 'Rp ' + formatNum(item.jumlah);
            document.getElementById('paySudah').textContent = 'Rp ' + formatNum(item.sudahDibayar || 0);
            document.getElementById('paySisa').textContent = 'Rp ' + formatNum(sisa);
            document.getElementById('payJumlah').value = '';
            payMode = '+';
            setPayMode('+');
            document.getElementById('payModal').classList.add('show');
            document.body.style.overflow = 'hidden';
            setTimeout(() => document.getElementById('payJumlah').focus(), 100);
        }

        function closePayModal() {
            document.getElementById('payModal').classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        function setBayarLunas() {
            const id = parseInt(document.getElementById('payId').value);
            const item = data.find(d => d.id === id);
            if (!item) return;
            const sisa = (parseFloat(item.jumlah) || 0) - (parseFloat(item.sudahDibayar) || 0);
            document.getElementById('payJumlah').value = sisa;
        }

        function savePembayaran() {
            const id = parseInt(document.getElementById('payId').value);
            const nominal = parseFloat(document.getElementById('payJumlah').value);
            if (!nominal || nominal <= 0) {
                alert('Masukkan jumlah yang valid!');
                return;
            }
            const idx = data.findIndex(d => d.id === id);
            if (idx === -1) return;
            let sudahDibayar = parseFloat(data[idx].sudahDibayar) || 0;
            if (payMode === '+') {
                sudahDibayar += nominal;
                if (sudahDibayar >= parseFloat(data[idx].jumlah)) {
                    sudahDibayar = parseFloat(data[idx].jumlah);
                    data[idx].status = 'Lunas';
                }
            } else {
                sudahDibayar -= nominal;
                if (sudahDibayar < 0) sudahDibayar = 0;
                data[idx].status = 'Belum Lunas';
            }
            data[idx].sudahDibayar = sudahDibayar;
            localStorage.setItem('hutangData', JSON.stringify(data));
            filteredData = [...data];
            applyFilter();
            closePayModal();
        }

        document.getElementById('payModal').addEventListener('click', function(e) {
            if (e.target === this) closePayModal();
        });

        function openAddModal() {
            document.getElementById('modalTitle').textContent = 'Tambah Hutang';
            document.getElementById('editId').value = '';
            document.getElementById('namaPihak').value = '';
            document.getElementById('jenisHutang').value = '';
            document.getElementById('jumlah').value = '';
            document.getElementById('status').value = 'Belum Lunas';
            document.getElementById('tanggalTransaksi').value = new Date().toISOString().split('T')[0];
            document.getElementById('jatuhTempo').value = '';
            document.getElementById('sudahDibayar').value = '0';

            document.getElementById('hutangModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function editHutang(id) {
            const item = data.find(d => d.id === id);
            if (!item) return;
            document.getElementById('modalTitle').textContent = 'Edit Hutang';
            document.getElementById('editId').value = id;
            document.getElementById('namaPihak').value = item.namaPihak;
            document.getElementById('jenisHutang').value = item.jenis;
            document.getElementById('jumlah').value = item.jumlah;
            document.getElementById('status').value = item.status;
            document.getElementById('tanggalTransaksi').value = item.tanggal;
            document.getElementById('jatuhTempo').value = item.jatuhTempo || '';
            document.getElementById('sudahDibayar').value = item.sudahDibayar || 0;

            document.getElementById('hutangModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function saveHutang() {
            const nama = document.getElementById('namaPihak').value.trim();
            const jenis = document.getElementById('jenisHutang').value;
            const jumlah = document.getElementById('jumlah').value;
            const tanggal = document.getElementById('tanggalTransaksi').value;

            if (!nama || !jenis || !jumlah || !tanggal) {
                alert('Nama, jenis, jumlah, dan tanggal transaksi wajib diisi!');
                return;
            }

            const editId = document.getElementById('editId').value;
            const newItem = {
                namaPihak: nama,
                jenis,
                jumlah: parseFloat(jumlah),
                tanggal,
                jatuhTempo: document.getElementById('jatuhTempo').value,
                status: document.getElementById('status').value,
                sudahDibayar: parseFloat(document.getElementById('sudahDibayar').value) || 0,

            };

            if (editId) {
                const idx = data.findIndex(d => d.id === parseInt(editId));
                if (idx > -1) data[idx] = { ...data[idx], ...newItem };
            } else {
                const newId = data.length > 0 ? Math.max(...data.map(d => d.id)) + 1 : 1;
                data.push({ id: newId, ...newItem });
            }

            localStorage.setItem('hutangData', JSON.stringify(data));
            closeModal();
            applyFilter();
        }

        function deleteHutang(id) {
            if (!confirm('Hapus data hutang ini?')) return;
            data = data.filter(d => d.id !== id);
            localStorage.setItem('hutangData', JSON.stringify(data));
            applyFilter();
        }

        function closeModal() {
            document.getElementById('hutangModal').classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        // ── PAGINATION ──
        function changeRowsPerPage(val) { rowsPerPage = parseInt(val); currentPage = 1; renderTable(); }
        function goToPrevPage() { if (currentPage > 1) { currentPage--; renderTable(); } }
        function goToNextPage() {
            const max = Math.ceil(filteredData.length / rowsPerPage) || 1;
            if (currentPage < max) { currentPage++; renderTable(); }
        }
        function goToPage(page) {
            const max = Math.ceil(filteredData.length / rowsPerPage) || 1;
            page = parseInt(page);
            if (page >= 1 && page <= max) { currentPage = page; renderTable(); }
            else { document.getElementById('currentPageInput').value = currentPage; }
        }

        // ── EXPORT ──
        function toggleAddMenu(e) {
            e.stopPropagation();
            document.getElementById('addDropdownMenu').classList.toggle('show');
        }

        function closeAddMenu() {
            document.getElementById('addDropdownMenu').classList.remove('show');
        }

        document.addEventListener('click', function() { closeAddMenu(); });

        function exportToCSV() {
            const headers = ['No', 'Nama Pihak', 'Jenis', 'Jumlah', 'Tgl Awal Hutang', 'Jatuh Tempo', 'Status', 'Sudah Dibayar', 'Sisa'];
            const rows = data.map((d, i) => [
                i + 1, d.namaPihak, d.jenis, d.jumlah, d.tanggal, d.jatuhTempo || '',
                d.status, d.sudahDibayar || 0,
                (parseFloat(d.jumlah) || 0) - (parseFloat(d.sudahDibayar) || 0)
            ]);
            const csv = [headers, ...rows].map(r => r.join(',')).join('\n');
            const a = document.createElement('a');
            a.href = URL.createObjectURL(new Blob([csv], { type: 'text/csv' }));
            a.download = 'catatan-hutang.csv';
            a.click();
        }

        // ── SIDEBAR & LOGOUT ──
        function handleLogout() {
            if (confirm('Apakah Anda yakin ingin keluar?')) window.location.href = 'index.html';
        }

        // ── CLOSE MODAL OUTSIDE ──
        document.getElementById('hutangModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });

        // ── INIT ──
        window.onload = () => applyFilter();
    </script>
    <script>
        function openSidebar() {
            document.getElementById('sidebar').classList.add('open');
            document.getElementById('sidebarOverlay').classList.add('show');
        }
        function closeSidebar() {
            document.getElementById('sidebar').classList.remove('open');
            document.getElementById('sidebarOverlay').classList.remove('show');
        }
    </script>
</body>
</html>